<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
  <script src="https://unpkg.com/react@16/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js" crossorigin></script>
</head>
<body>
  <div id="root"></div>
</body>
<script type="text/babel">
  class Welcome extends React.Component {
    constructor(props){
      super(props)
      // this.onClick = this.onClick.bind(this)
      // this.state = {
      //   name: 'aaa',
      //   count: 1
      // }
    }
    state = {
      name: 'bbb',
      count: 2
    }

    componentDidMount(){
      console.log('this.',this.onClick)
    }
    // UNSAFE_componentWillReceiveProps(props){
    //   console.log('componentWillReceiveProps',props)
    // }
    // UNSAFE_componentWillMount(){
    //   console.log('UNSAFE_componentWillMount')
    // }
    static getDerivedStateFromProps(props,state){
      console.log('getDerivedStateFromProps props',props)
      console.log('getDerivedStateFromProps state',state)
      const { defaultName } = props
      if (defaultName === 'defaultName') {
        return {
          name: 'defaultName',
          count: 1
        }
      }
      return null
    }

    /* getSnapshotBeforeUpdate(prevProps, prevState){
      console.log('prevProps',prevProps)
      console.log('prevState',prevState)
      return 100
    } */

    componentDidUpdate(prevProps, prevState, snap){
      console.log('componentDidUpdate')
    }

    onClick(){
      const { name, count } = this.state
      console.log('count',count)
      // this.setState({
      //   name: name + name
      // })
      // this.setState({ count: count+1 })
      this.setState({
        count: count+1
      }, (arg) => {
        console.log('arg', arg)
        console.log('count',count)
        // this.setState({
        //   count: count+1
        // })
      })
      this.setState((props, state) => {
        console.log('props', props)
        console.log('state', state)
        return {
          count: count+1
        }
      })
    }
    render(){
      const { count } = this.state
      return (
        <div>
          <h1>Hello, world!</h1>
          <h2>{count}</h2>
          <button onClick={this.onClick}>onClick</button>
        </div>
      )
    }
  }

  const Fragment = () => (true)

  class App extends React.Component {
    constructor(){
      super()
      this.onClick = this.onClick.bind(this)
      this.state = {
        defaultName: 'defaultName'
      }
    }
    onClick () {
      this.setState({
        defaultName: 'changeName'
      })
    }
    render(){
      const {defaultName} = this.state
      return (
        <div>
          <Welcome defaultName={defaultName}/>
          <Fragment/>
          <button onClick={this.onClick}>defaultName</button>
          <h2>It is {new Date().toLocaleTimeString()}.</h2>
        </div>
      )
    }
  }
  ReactDOM.render(<App/>, document.getElementById('root'));


</script>
</html>